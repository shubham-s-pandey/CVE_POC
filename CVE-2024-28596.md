# CVE-2024-28596:

## Description:
```h2oai was discovered to contain a shell injection vulnerability via the component subprocess.check_output.```

## Vulnerability Type:
```Code Injection```

## Affected Product Code Base:
```https://github.com/h2oai/h2ogpt/blob/main/tests/test_inference_servers.py```

## Affected Component:
```test_inference_servers.py```

## Attack Vectors:
```
Vulnerability in the Code:
The provided code has a vulnerability due to the use of subprocess.check_output() with the shell=True parameter. This can lead to a shell injection vulnerability, which allows an attacker to execute arbitrary commands on the system.

When shell=True is used, the command is executed through the shell. It can be manipulated by an attacker to execute unintended commands.

In the provided code, cmd is executed using the subprocess.run method with shell=True enabled. The shell=True argument means that the command is executed by the system shell, which allows for command chaining and other potentially malicious operations.

Proof of Concept:
Code Snippet: o = subprocess.check_output(cmd, shell=True, timeout=15)
In this PoC, the attacker appends malicious command, leads to executing arbitrary commands on the system.
```

## Discoverer:
```Shubham Pandey```

## Reference:
```
https://github.com/h2oai/h2ogpt/blob/main/tests/test_inference_servers.py
https://www.owasp.org/index.php/Command_Injection
https://docs.python.org/3/library/subprocess.html
```